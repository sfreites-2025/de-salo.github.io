<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Caleidoscopio de Emociones</title>
  <style>
    body {
      margin: 0; padding: 0;
      min-height: 100vh; width: 100vw;
      box-sizing: border-box;
      font-family: "Times New Roman", Times, serif;
      background: radial-gradient(circle at 60% 40%, #ffe5e5 0%, #c6eaff 60%, #fff 100%);
      overflow: hidden;
      color: #311b92;
    }
    canvas {
      display: block;
      position: fixed;
      left: 0; top: 0;
      width: 100vw; height: 100vh;
      z-index: 1;
      pointer-events: none;
    }
    .header {
      position: absolute; z-index: 10;
      left: 0; right: 0; top: 4vw; text-align: center;
      font-size: 2.3em; font-weight: bold;
      color: #901fa8; letter-spacing: 0.04em;
      text-shadow: 0 3px 12px #fff8, 0 1.5px 10px #81d0ec8f;
      user-select: none;
      animation: fadeHeader 2s;
    }
    @keyframes fadeHeader {
      from { opacity: 0; filter: blur(10px);}
      to { opacity: 1; filter: none;}
    }
    #kaleidoscope {
      pointer-events: none;
      position: fixed;
      left: 0; top: 0;
      width: 120px; height: 120px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(180,250,255,0.65) 55%, rgba(210,140,255,0.13) 100%);
      box-shadow: 0 0 30px 20px #ed7ae2bb, 0 0 80px 40px #a6f6ffa9;
      border: 2.7px solid #b16ded8c;
      mix-blend-mode: lighten;
      z-index: 30;
      animation: kaleidoPulse 1.2s infinite alternate;
    }
    @keyframes kaleidoPulse {
      0% { box-shadow: 0 0 30px 18px #ed7ae180; }
      100% { box-shadow: 0 0 35px 30px #a6f6ffa3; }
    }
    .bubble {
      position: absolute; z-index: 3;
      width: 88px; height: 88px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 2.3em;
      font-family: "Times New Roman", Times, serif;
      cursor: pointer;
      box-shadow: 0 4px 29px #ff9ab955, 0 1.1px 17px #65c9ef60;
      transition: transform 0.2s, box-shadow 0.25s;
      animation: floatBub 4.4s infinite alternate cubic-bezier(.56,.13,.71,1.17);
      background: radial-gradient(circle at 60% 60%, #fff 30%, #e2e1fc 100%);
      user-select: none;
      color: #6a0dad;
      font-weight: bold;
    }
    @keyframes floatBub {
      0% { transform: translateY(0px);}
      100% { transform: translateY(-22px) scale(1.07);}
    }
    .bubble.revealed { opacity: 0; pointer-events: none; transition: opacity 1s; }
    .reveal-modal {
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      background: rgba(255,255,255,0.91);
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      z-index: 10001;
      animation: popIn 0.45s cubic-bezier(.4,2,.22,1.07);
    }
    @keyframes popIn {
      0% { opacity: 0; transform: scale(0.8);}
      70%{ opacity:.86;}
      100%{ opacity: 1; transform: scale(1);}
    }
    .modal-card {
      min-width: 310px; max-width: 80vw; min-height: 220px;
      background: linear-gradient(130deg,#fff0fa 67%, #c1fff0 100%);
      border-radius: 42px;
      box-shadow: 0 4px 32px #ffb2f8d0, 0 2px 33px #a3fcffbc;
      padding: 44px 30px 33px 30px;
      text-align: center;
      color: #902aba;
      font-family: "Times New Roman", Times, serif;
      animation: cardPop 0.85s cubic-bezier(.4,2,.22,1.07) both;
    }
    @keyframes cardPop {
      0% {opacity:0; transform: scale(0.8);}
      70%{opacity: .76;}
      100%{opacity:1;  transform: scale(1);}
    }
    .modal-emoji {
      font-size: 3em;
      margin-bottom: 13px;
      display: block;
      animation: emojiPulse 1.5s infinite alternate;
    }
    @keyframes emojiPulse {
      0% { filter: blur(0); }
      100% { filter: blur(1.5px) brightness(1.2);}
    }
    .modal-text {
      font-size: 1.23em;
      margin-bottom: 24px;
      letter-spacing: 0.02em;
      color: #741b7c;
      white-space: pre-wrap;
    }
    .close-btn {
      background: linear-gradient(99deg,#7ae0ea,#fd558e 85%);
      color: #5c128b;
      font-weight: bold;
      font-family: "Times New Roman", Times, serif;
      padding: 13px 44px;
      border-radius: 16px;
      border: none;
      box-shadow: 0 1px 13px #f198ff33;
      letter-spacing: 0.03em;
      cursor: pointer;
      animation: btnpulseIn 1.3s infinite alternate;
      outline: none;
    }
    .final-msg {
      font-size: 1.44em;
      color: #4d2671;
      font-weight: 600;
      letter-spacing: 0.02em;
      margin-top: 15px;
      margin-bottom: 0;
      text-align: center;
      animation: finalAp 1.7s both;
      font-family: "Times New Roman", Times, serif;
    }
    @keyframes finalAp {
      from { opacity: 0; transform: translateY(40px);}
      to { opacity: 1; transform: none;}
    }
    @keyframes btnpulseIn {
      0% { box-shadow: 0 2px 13px #aebaff75;}
      100% { box-shadow: 0 6px 26px #ffe4faaf;}
    }
    @media (max-width: 700px) {
      .modal-card {
        min-width: unset;
        max-width: 96vw;
        padding: 3vw;
      }
    }
  </style>
</head>
<body>
  <div class="header">Caleidoscopio de Emociones</div>
  <div id="kaleidoscope"></div>
  
  <script>
    // Datos con textos dados y emojis arbitrarios bonitos para cada texto
    const bubbleData = [
      { emoji: 'ðŸ¤—', msg: "Nada reemplaza un buen abrazo tuyo" },
      { emoji: 'ðŸŽ‰', msg: "Siempre buscaste formas de sorprenderme" },
      { emoji: 'ðŸ¤', msg: "Gracias por ser un apoyo fundamental en mi vida" },
      { emoji: 'ðŸŽµ', msg: "Hay canciones como lo son 506 de Morat, que me llevan a ti" },
      { emoji: 'ðŸŒ…', msg: "Lo cotidiano contigo siempre fue especial" },
      { emoji: 'ðŸ’ª', msg: "Supiste ser fuerte por los dos muchas veces" },
      { emoji: 'ðŸ˜Œ', msg: "Tu presencia en mi vida me trajo calma" },
      { emoji: 'âœ¨', msg: "Nunca nada fue perfecto, pero sÃ­ fue Ãºnico" },
      { emoji: 'ðŸ¤—', msg: "Muchas veces te necesitÃ© y estuviste ahÃ­" },
      { emoji: 'ðŸŒŸ', msg: "Rebasaste mis expectativas cada dÃ­a mÃ¡s" },
      { emoji: 'â¤ï¸', msg: "Amaste como nunca lo habÃ­as hecho" },
      { emoji: 'ðŸ·', msg: "JamÃ¡s te olvidarÃ©, mi copita" }
    ];

    // Crear kaleidoscopio
    const kaleido = document.createElement('div');
    kaleido.id = 'kaleidoscope';
    document.body.appendChild(kaleido);

    function updateKaleidoPos(x, y) {
      kaleido.style.left = (x - 60) + 'px';
      kaleido.style.top = (y - 60) + 'px';
    }
    document.addEventListener('mousemove', e => updateKaleidoPos(e.clientX, e.clientY));
    document.addEventListener('touchmove', e => { 
      if(e.touches && e.touches[0]) updateKaleidoPos(e.touches[0].clientX, e.touches[0].clientY);
    });
    updateKaleidoPos(window.innerWidth/2, window.innerHeight/2);

    // Render de burbujas
    const bubbles = [];
    function renderBubbles() {
      for(let i = 0; i < bubbleData.length; i++) {
        const div = document.createElement('div');
        div.className = 'bubble';
        div.textContent = bubbleData[i].emoji;
        const angle = 2 * Math.PI * i / bubbleData.length + Math.random() * 0.15;
        const centerX = window.innerWidth / 2 + Math.cos(angle) * 210 + Math.random() * 60 - 30;
        const centerY = window.innerHeight / 2 + Math.sin(angle) * 160 + Math.random() * 55 - 25;
        div.style.left = (centerX - 44) + 'px';
        div.style.top = (centerY - 44) + 'px';
        div.dataset.index = i;
        document.body.appendChild(div);
        bubbles.push(div);
        div.addEventListener('mouseenter', () => {
          div.style.transform = 'scale(1.22) rotate(-2deg)';
          div.style.boxShadow = '0 6px 24px #fff8,0 4px 38px #ffbebb9a';
        });
        div.addEventListener('mouseleave', () => {
          div.style.transform = 'scale(1)';
          div.style.boxShadow = '';
        });
        div.addEventListener('click', () => showModal(i, div));
      }
    }

    let revealed = [];

    function showModal(idx, bubble) {
      if (revealed.includes(idx)) return;
      revealed.push(idx);
      bubble.classList.add('revealed');
      // Crear y mostrar modal
      const modal = document.createElement('div');
      modal.className = 'reveal-modal';
      modal.innerHTML = `
        <div class="modal-card">
          <span class="modal-emoji">${bubbleData[idx].emoji}</span>
          <div class="modal-text">${bubbleData[idx].msg}</div>
          <button class="close-btn">${revealed.length < bubbleData.length 
            ? `Faltan (${bubbleData.length - revealed.length})`
            : 'Â¡Ver mensaje final!'}</button>
        </div>
      `;
      document.body.appendChild(modal);
      modal.querySelector('.close-btn').onclick = () => {
        modal.remove();
        if (revealed.length === bubbleData.length) showFinalMessage();
      };
    }

    function showFinalMessage() {
      const finalModal = document.createElement('div');
      finalModal.className = 'reveal-modal';
      finalModal.innerHTML = `
        <div class="modal-card" style="padding: 40px 20px 30px 20px;">
          <div class="final-msg">
            Gracias por explorar este caleidoscopio.<br>
            Cada emociÃ³n, cada recuerdo... los llevas contigo.<br>
            <span style="font-size:1.44em; color:#f764bd;">ðŸ’–</span>
          </div>
          <button class="close-btn">Jugar de nuevo</button>
        </div>
      `;
      document.body.appendChild(finalModal);
      finalModal.querySelector('.close-btn').onclick = () => {
        finalModal.remove();
        revealed = [];
        bubbles.forEach(b => {
          b.classList.remove('revealed');
        });
      };
    }

    renderBubbles();
  </script>
</body>
</html>
