<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Semáforo con control de duración</title>
<style>
  body {
    margin: 0; padding: 0;
    height: 100vh;
    background: #222;
    font-family: 'Times New Roman', serif;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  /* Contenedor Semáforo (izquierda) */
  .container-semaforo {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    padding-left: 40px;
    height: 100vh;
    flex-shrink: 0;
  }
  .semaforo {
    background: black;
    border-radius: 30px;
    width: 120px;
    padding: 20px 0;
    box-shadow: 0 0 15px #000;
    display: flex;
    flex-direction: column;
    gap: 18px;
    align-items: center;
  }
  .luz {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    border: 3.5px solid #111;
    background-color: #222;
    box-shadow: inset 0 6px 12px #0008;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.6s, box-shadow 0.6s;
    position: relative;
  }

  /* Corazones en luces */
  .luz.rojo.on {
    background-color: transparent;
    box-shadow: none;
  }
  .luz.rojo.on::before {
    content: '❤️';
    font-size: 64px;
    color: #ff2c2c;
    text-shadow: 0 0 8px #ff4c4c, 0 0 20px #ff6b6b;
    animation: pulseHeartRed 1.5s infinite alternate ease-in-out;
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -55%);
  }
  @keyframes pulseHeartRed {
    0% { text-shadow: 0 0 8px #ff4c4c, 0 0 20px #ff6b6b; transform: translate(-50%, -55%) scale(1); }
    100% { text-shadow: 0 0 14px #ff5c5c, 0 0 28px #ff8787; transform: translate(-50%, -55%) scale(1.12); }
  }

  .luz.amarillo.on {
    background-color: transparent;
    box-shadow: none;
  }
  .luz.amarillo.on::before {
    content: '💛';
    font-size: 64px;
    color: #ffd93b;
    text-shadow: 0 0 10px #ffeb7b, 0 0 25px #ffeb7baa;
    animation: pulseHeartYellow 1.5s infinite alternate ease-in-out;
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -55%);
  }
  @keyframes pulseHeartYellow {
    0% { text-shadow: 0 0 10px #ffeb7b, 0 0 25px #ffeb7baa; transform: translate(-50%, -55%) scale(1); }
    100% { text-shadow: 0 0 16px #fff156, 0 0 32px #fff156bb; transform: translate(-50%, -55%) scale(1.12); }
  }

  .luz.verde.on {
    background-color: transparent;
    box-shadow: none;
  }
  .luz.verde.on::before {
    content: '💚';
    font-size: 64px;
    color: #37d04e;
    text-shadow: 0 0 10px #4eff75, 0 0 25px #4eff75aa;
    animation: pulseHeartGreen 1.5s infinite alternate ease-in-out;
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -55%);
  }
  @keyframes pulseHeartGreen {
    0% { text-shadow: 0 0 10px #4eff75, 0 0 25px #4eff75aa; transform: translate(-50%, -55%) scale(1); }
    100% { text-shadow: 0 0 16px #2ceb37, 0 0 32px #2ceb37cc; transform: translate(-50%, -55%) scale(1.12); }
  }

  /* Controles centrados */
  #controls {
    background: #111;
    color: #eee;
    padding: 30px 25px;
    font-size: 1.15em;
    box-shadow: 0 0 20px #000, inset 0 0 10px #552233bb;
    display: flex;
    flex-direction: column;
    gap: 20px;
    border-radius: 20px;
    margin: auto;
    text-align: center;
    max-width: 320px;
    user-select: none;
  }
  #controls h2 {
    margin-top: 0;
    color: #ffd93b;
  }
  #controls label {
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 12px;
  }
  #controls input[type="checkbox"] {
    width: 22px; height: 22px;
    cursor: pointer;
    accent-color: #ff2c2c;
  }
  #controls input[type="number"] {
    width: 80px;
    padding: 4px 8px;
    border-radius: 6px;
    border: none;
    font-size: 1em;
    margin-left: 12px;
    text-align: center;
  }
  #controls .control-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
  }
</style>
</head>
<body>
  <div class="container-semaforo" aria-label="Semáforo de tráfico con control">
    <div class="semaforo" role="region" aria-live="polite" aria-atomic="true">
      <div id="rojo" class="luz rojo" aria-label="Corazón rojo apagado"></div>
      <div id="amarillo" class="luz amarillo" aria-label="Corazón amarillo apagado"></div>
      <div id="verde" class="luz verde" aria-label="Corazón verde apagado"></div>
    </div>
  </div>

  <div id="controls" aria-label="Controles de encendido y duración de luces del semáforo">
    <h2>Control de Luces y Duración (segundos)</h2>

    <label class="control-row">
      <input type="checkbox" id="chkRojo" checked>
      Luz Roja
      <input type="number" id="timeRojo" min="1" max="99" value="3" aria-label="Duración luz roja en segundos">
    </label>

    <label class="control-row">
      <input type="checkbox" id="chkAmarillo" checked>
      Luz Amarilla
      <input type="number" id="timeAmarillo" min="1" max="99" value="1.5" step="0.1" aria-label="Duración luz amarilla en segundos">
    </label>

    <label class="control-row">
      <input type="checkbox" id="chkVerde" checked>
      Luz Verde
      <input type="number" id="timeVerde" min="1" max="99" value="3" aria-label="Duración luz verde en segundos">
    </label>
  </div>

<script>
  const rojo = document.getElementById('rojo');
  const amarillo = document.getElementById('amarillo');
  const verde = document.getElementById('verde');

  const chkRojo = document.getElementById('chkRojo');
  const chkAmarillo = document.getElementById('chkAmarillo');
  const chkVerde = document.getElementById('chkVerde');

  const timeRojo = document.getElementById('timeRojo');
  const timeAmarillo = document.getElementById('timeAmarillo');
  const timeVerde = document.getElementById('timeVerde');

  // Estados del semáforo: rojo, rojo+amarillo, verde, amarillo
  const estados = [
    {rojo: true, amarillo: false, verde: false},
    {rojo: true, amarillo: true, verde: false},
    {rojo: false, amarillo: false, verde: true},
    {rojo: false, amarillo: true, verde: false}
  ];

  let indice = 0;

  function getDuracionEstado(idx) {
    // Retorna el tiempo en milisegundos según estado del índice,
    // usando los valores ingresados por el usuario o valores por defecto.
    switch(idx) {
      case 0: return (parseFloat(timeRojo.value) || 3) * 1000;
      case 1: {
        // cuando rojo + amarillo, usa máximo entre rojo y amarillo para mantener visible ambos
        const rojoT = parseFloat(timeRojo.value) || 3;
        const amarilloT = parseFloat(timeAmarillo.value) || 1.5;
        return Math.max(rojoT, amarilloT) * 1000;
      }
      case 2: return (parseFloat(timeVerde.value) || 3) * 1000;
      case 3: return (parseFloat(timeAmarillo.value) || 1.5) * 1000;
      default: return 3000;
    }
  }

  function actualizarSemaforo() {
    const estado = estados[indice];

    rojo.classList.toggle('on', estado.rojo && chkRojo.checked);
    rojo.setAttribute('aria-label', (estado.rojo && chkRojo.checked) ? 'Corazón rojo encendido' : 'Corazón rojo apagado');

    amarillo.classList.toggle('on', estado.amarillo && chkAmarillo.checked);
    amarillo.setAttribute('aria-label', (estado.amarillo && chkAmarillo.checked) ? 'Corazón amarillo encendido' : 'Corazón amarillo apagado');

    verde.classList.toggle('on', estado.verde && chkVerde.checked);
    verde.setAttribute('aria-label', (estado.verde && chkVerde.checked) ? 'Corazón verde encendido' : 'Corazón verde apagado');

    // Leer duración dinámica
    let delay = getDuracionEstado(indice);
    indice = (indice + 1) % estados.length;
    setTimeout(actualizarSemaforo, delay);
  }

  // Al cambiar checkbox o input actualiza el semáforo inmediatamente
  function actualizarVisual() {
    const estadoActual = estados[(indice + estados.length - 1) % estados.length];
    rojo.classList.toggle('on', estadoActual.rojo && chkRojo.checked);
    amarillo.classList.toggle('on', estadoActual.amarillo && chkAmarillo.checked);
    verde.classList.toggle('on', estadoActual.verde && chkVerde.checked);
  }

  [chkRojo, chkAmarillo, chkVerde, timeRojo, timeAmarillo, timeVerde].forEach(elem => {
    elem.addEventListener('input', actualizarVisual);
  });

  actualizarSemaforo();
</script>
</body>
</html>
